Скриншот 2.01: Главная функция бота (neuro_nutritionist_bot)
Описание:
На этом скриншоте показана основная функция чат-бота, которая реализует логику общения с пользователем:

Сначала происходит фильтрация пользовательского ввода для блокировки опасных или нецензурных запросов.

Затем осуществляется RAG-поиск (Retrieval-Augmented Generation) — извлекаются релевантные факты из базы знаний на основе вопроса пользователя.

Формируется системный промпт для языковой модели, чтобы ответ был основан строго на найденных фрагментах.

Запускается запрос к OpenAI GPT-3.5-turbo, после чего ответ форматируется и выводится пользователю.

В нижней части показан пример вызова функции: бот корректно отвечает на вопрос "Сколько калорий в яблоке?" на основании базы.





Скриншот 2.02: Фильтрация опасных и нецензурных запросов
Описание:
Данный скриншот иллюстрирует реализацию фильтрации пользовательских запросов:

Определены списки нецензурных слов и опасных фраз, которые не допускаются к обработке.

Функция check_filter проверяет ввод пользователя и, при обнаружении запрещённых слов или опасных тем (например, про "секретные таблетки" или "быстрое похудение"), сразу возвращает предупреждение.

В нижней части видно тестовый запуск: ввод опасного запроса приводит к корректному сообщению о недопустимости обсуждения.




Скриншот 2.03: RAG-поиск и поиск чанков
Описание:
Здесь показаны функции для поиска по базе знаний на этапе Retrieval:

Функция rag_search осуществляет векторный поиск наиболее релевантных фрагментов из базы по пользовательскому запросу, убирает дубликаты.

Функция search_chunks выводит топ-3 найденных чанка для наглядности.

Ниже представлен пример запроса ("Какие витамины в яблоке?"), а также результат работы: бот находит сразу несколько релевантных фрагментов — о витаминах и ссылку на источник.